<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¦¬ë·°ì‘ì„± (ì†Œë¹„ì)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            padding: 40px;
            max-width: 800px;
            width: 100%;
        }
        
        h1 {
            color: #4ecdc4;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            color: #333;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #4ecdc4;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 150px;
        }
        
        .rating-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .rating-stars {
            display: flex;
            gap: 5px;
        }
        
        .star {
            font-size: 2em;
            color: #ddd;
            cursor: pointer;
            transition: color 0.2s ease;
        }
        
        .star:hover,
        .star.active {
            color: #4ecdc4;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 30px;
        }
        
        .btn {
            flex: 1;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .submit-btn {
            background: #4ecdc4;
            color: white;
        }
        
        .submit-btn:hover {
            background: #44a08d;
            transform: translateY(-2px);
        }
        
        .back-btn {
            background: white;
            color: #4ecdc4;
            border: 2px solid #4ecdc4;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        
        .back-btn:hover {
            background: #4ecdc4;
            color: white;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒŸ ë¦¬ë·°ì‘ì„± (ì†Œë¹„ì)</h1>
        
        <form id="reviewForm">
            <div class="form-group">
                <label for="rating">í‰ì </label>
                <div class="rating-group">
                    <div class="rating-stars">
                        <span class="star" data-rating="1">â˜…</span>
                        <span class="star" data-rating="2">â˜…</span>
                        <span class="star" data-rating="3">â˜…</span>
                        <span class="star" data-rating="4">â˜…</span>
                        <span class="star" data-rating="5">â˜…</span>
                    </div>
                    <span id="ratingValue" style="color: #666; font-weight: 600;">0ì </span>
                </div>
            </div>
            
            <div class="form-group">
                <label for="reviewContent">ë¦¬ë·° ë‚´ìš©</label>
                <textarea id="reviewContent" placeholder="ë¦¬ë·°ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”" required></textarea>
            </div>
            
            <div class="button-group">
                <button type="submit" class="btn submit-btn">ì‘ì„± ì™„ë£Œ</button>
                <a href="index.html" class="btn back-btn">ì·¨ì†Œ</a>
            </div>
        </form>
    </div>
    
    <script>
        // ë¦¬ë·° ê°ì • ë¶„ì„ í•¨ìˆ˜
        function analyzeReviewSentiment(content, rating) {
            const positiveKeywords = ['ì¢‹ì•„', 'ë§›ìˆ', 'í›Œë¥­', 'ì™„ë²½', 'ìµœê³ ', 'ìµœê³ ì˜', 'ì¶”ì²œ', 'ê°ì‚¬', 'ê°ë™', 'ì¹œì ˆ', 'ê¹”ë”', 'ì‹ ì„ '];
            const negativeKeywords = ['ë³„ë¡œ', 'ëŠë ¤', 'ë¶ˆì¹œì ˆ', 'ë¶ˆë§Œ', 'ë¹„ìœ„ìƒ', 'ë¶ˆë§Œì¡±', 'í™˜ë¶ˆ', 'ì‹¤ë§', 'ë‚˜ì˜', 'ìµœì•…', 'ë¶ˆí¸'];
            
            const contentLower = content.toLowerCase();
            
            if (rating <= 2) {
                return 'negative';
            }
            
            if (rating >= 4) {
                return 'positive';
            }
            
            let positiveCount = 0;
            let negativeCount = 0;
            
            positiveKeywords.forEach(keyword => {
                if (contentLower.includes(keyword)) {
                    positiveCount++;
                }
            });
            
            negativeKeywords.forEach(keyword => {
                if (contentLower.includes(keyword)) {
                    negativeCount++;
                }
            });
            
            if (positiveCount > negativeCount) {
                return 'positive';
            } else if (negativeCount > positiveCount) {
                return 'negative';
            }
            
            return 'neutral';
        }
        
        // ê°ì •ë³„ ìë™ ë‹µê¸€ ìƒì„±
        function generateSmartReply(content, rating) {
            const sentiment = analyzeReviewSentiment(content, rating);
            
            const replies = {
                positive: [
                    'ê°ì‚¬í•©ë‹ˆë‹¤! ì¢‹ì€ í‰ê°€ ì£¼ì…”ì„œ ì§„ì‹¬ìœ¼ë¡œ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤. ë”ìš± ë…¸ë ¥í•˜ê² ìŠµë‹ˆë‹¤! ğŸ™',
                    'ê³ ê°ë‹˜ì˜ ë§Œì¡±ì´ ì €í¬ì˜ ë³´ëŒì…ë‹ˆë‹¤. ì–¸ì œë‚˜ ìµœì„ ì„ ë‹¤í•˜ê² ìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ˜Š',
                    'ì¢‹ì€ ë§ì”€ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤. ì•ìœ¼ë¡œë„ ì¢‹ì€ ì„œë¹„ìŠ¤ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤! ğŸ™Œ',
                    'í–‰ë³µí•œ ì‹ì‚¬ê°€ ë˜ì…¨ë‹¤ë‹ˆ ê¸°ì©ë‹ˆë‹¤. í•­ìƒ ê°ì‚¬í•©ë‹ˆë‹¤! â¤ï¸'
                ],
                neutral: [
                    'ë¦¬ë·° ë‚¨ê²¨ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ë” ë‚˜ì€ ì„œë¹„ìŠ¤ë¡œ ë³´ë‹µí•˜ê² ìŠµë‹ˆë‹¤! ğŸ™',
                    'ì–¸ì œë‚˜ ìµœì„ ì„ ë‹¤í•˜ê² ìŠµë‹ˆë‹¤. ê´€ì‹¬ ê°€ì ¸ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ˜Š',
                    'ì†Œì¤‘í•œ ì˜ê²¬ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤. ê³„ì† ê°œì„ í•´ë‚˜ê°€ê² ìŠµë‹ˆë‹¤! ğŸ™Œ'
                ],
                negative: [
                    'ë¶ˆí¸ì„ ë“œë ¤ ì£„ì†¡í•©ë‹ˆë‹¤. ì†Œì¤‘í•œ ì˜ê²¬ì„ ë°˜ì˜í•˜ì—¬ ê°œì„ í•˜ê² ìŠµë‹ˆë‹¤. ğŸ™',
                    'ê³ ê°ë‹˜ì˜ í”¼ë“œë°±ì´ ì €í¬ì—ê²Œ í° ë„ì›€ì´ ë©ë‹ˆë‹¤. ì¦‰ì‹œ ê°œì„ í•˜ê² ìŠµë‹ˆë‹¤. ğŸ˜”',
                    'ë¶ˆí¸ì„ ë“œë ¤ ì •ë§ ì£„ì†¡í•©ë‹ˆë‹¤. ë” ë‚˜ì€ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•´ ë…¸ë ¥í•˜ê² ìŠµë‹ˆë‹¤. ğŸ™',
                    'ì†Œì¤‘í•œ ì§€ì  ê°ì‚¬ë“œë¦½ë‹ˆë‹¤. ë°”ë¡œ ì¡°ì¹˜í•˜ì—¬ ê°œì„ í•˜ê² ìŠµë‹ˆë‹¤. ğŸ˜Š'
                ]
            };
            
            const repliesForSentiment = replies[sentiment];
            const randomIndex = Math.floor(Math.random() * repliesForSentiment.length);
            return repliesForSentiment[randomIndex];
        }
        
        // 2ì°¨ ë‹µê¸€ ìŠ¤ì¼€ì¤„ë§ í•¨ìˆ˜ (ì¼ë°˜ ë¦¬ë·° - ë¦¬ë·° ì‘ì„± ì‹œ)
        function scheduleSecondReplyInReview(review) {
            const secondReplyDelay = localStorage.getItem('secondReplyDelay');
            const secondReplyText = localStorage.getItem('secondReplyText');
            
            if (!secondReplyDelay || !secondReplyText) {
                return;
            }
            
            const delayMinutes = parseInt(secondReplyDelay);
            if (!delayMinutes || delayMinutes <= 0) {
                return;
            }
            
            review.pendingSecondReply = {
                text: secondReplyText.trim(),
                delayMinutes: delayMinutes,
                scheduledTime: Date.now() + (delayMinutes * 60 * 1000)
            };
        }
        
        let selectedRating = 0;
        
        // ë³„ì  í´ë¦­ ì´ë²¤íŠ¸
        const stars = document.querySelectorAll('.star');
        const ratingValue = document.getElementById('ratingValue');
        
        stars.forEach((star, index) => {
            star.addEventListener('click', function() {
                selectedRating = index + 1;
                updateStars();
                ratingValue.textContent = selectedRating + 'ì ';
            });
        });
        
        function updateStars() {
            stars.forEach((star, index) => {
                if (index < selectedRating) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
        }
        
        // í¼ ì œì¶œ ì´ë²¤íŠ¸
        document.getElementById('reviewForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const reviewContent = document.getElementById('reviewContent').value;
            
            if (selectedRating === 0) {
                alert('í‰ì ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ë¦¬ë·° ë°ì´í„° ìƒì„±
            const now = Date.now();
            const reviewData = {
                id: now, // ê³ ìœ  ID ìƒì„±
                rating: selectedRating,
                content: reviewContent,
                date: new Date().toLocaleString('ko-KR'), // ì‘ì„±ì¼
                timestamp: now, // ì‘ì„± ì‹œê° (ë°€ë¦¬ì´ˆ)
                replies: [] // ë‹µê¸€ ë°°ì—´ ì´ˆê¸°í™”
            };
            
            // localStorageì— ì €ì¥ (ê¸°ì¡´ ë¦¬ë·°ë“¤ ê°€ì ¸ì˜¤ê¸°)
            let reviews = [];
            const storedReviews = localStorage.getItem('reviews');
            if (storedReviews) {
                reviews = JSON.parse(storedReviews);
            }
            
            // ìë™ ë‹µê¸€ ì„¤ì • ì •ë³´ ì €ì¥ (í† ê¸€ì´ ONì´ê³  ì„¤ì •ëœ ê²½ìš°)
            const autoReplyEnabled = localStorage.getItem('autoReplyEnabled');
            const autoReplyText = localStorage.getItem('autoReplyText');
            const autoReplyDelay = localStorage.getItem('autoReplyDelay');
            const aiReplyEnabled = localStorage.getItem('aiReplyEnabled') === 'true';
            
            // ê°ì • ê¸°ë°˜ ìë™ ë‹µê¸€ì´ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ ë¬´ì¡°ê±´ ë‹¬ê¸°
            if (aiReplyEnabled) {
                const aiReply = generateSmartReply(reviewContent, selectedRating);
                
                if (autoReplyEnabled === 'true' && autoReplyText && autoReplyText.trim() !== '') {
                    // ê³ ì • ë¬¸êµ¬ë„ ìˆìœ¼ë©´ í•¨ê»˜ ì¶”ê°€
                    const replyContent = aiReply + '\n\n' + autoReplyText.trim();
                    const delayMinutes = autoReplyDelay !== null ? parseInt(autoReplyDelay) : null;
                    
                    if (delayMinutes === 0) {
                        // ì§€ì—°ì‹œê°„ì´ 0ì´ë©´ ì¦‰ì‹œ ë‹µê¸€ ì¶”ê°€
                        reviewData.replies.push({
                            id: now + Math.random(),
                            author: 'ê´€ë¦¬ì',
                            content: replyContent,
                            date: new Date().toLocaleString('ko-KR'),
                            isAuto: true
                        });
                        
                        // ì¦‰ì‹œ ë‹µê¸€ ì¶”ê°€ í›„ 2ì°¨ ë‹µê¸€ ìŠ¤ì¼€ì¤„ë§
                        scheduleSecondReplyInReview(reviewData);
                    } else if (delayMinutes !== null) {
                        // ì§€ì—°ì‹œê°„ì´ ìˆìœ¼ë©´ pendingAutoReplyì— ì €ì¥
                        reviewData.pendingAutoReply = {
                            text: replyContent,
                            delayMinutes: delayMinutes,
                            scheduledTime: now + (delayMinutes * 60 * 1000)
                        };
                    }
                } else {
                    // ê³ ì • ë¬¸êµ¬ê°€ ì—†ìœ¼ë©´ ê°ì • ê¸°ë°˜ ë‹µê¸€ë§Œ ì¶”ê°€
                    reviewData.replies.push({
                        id: now + Math.random(),
                        author: 'ê´€ë¦¬ì',
                        content: aiReply,
                        date: new Date().toLocaleString('ko-KR'),
                        isAuto: true,
                        isAI: true
                    });
                }
            } else if (autoReplyEnabled === 'true' && autoReplyText && autoReplyText.trim() !== '') {
                // ìë™ ë‹µê¸€ì´ í™œì„±í™”ë˜ì–´ ìˆê³  ê°ì • ê¸°ë°˜ ìë™ ë‹µê¸€ì´ ì—†ì„ ë•Œ
                const delayMinutes = autoReplyDelay !== null ? parseInt(autoReplyDelay) : null;
                
                if (delayMinutes === 0) {
                    // ì§€ì—°ì‹œê°„ì´ 0ì´ë©´ ì¦‰ì‹œ ë‹µê¸€ ì¶”ê°€
                    reviewData.replies.push({
                        id: now + Math.random(),
                        author: 'ê´€ë¦¬ì',
                        content: autoReplyText.trim(),
                        date: new Date().toLocaleString('ko-KR'),
                        isAuto: true
                    });
                    
                    // ì¦‰ì‹œ ë‹µê¸€ ì¶”ê°€ í›„ 2ì°¨ ë‹µê¸€ ìŠ¤ì¼€ì¤„ë§
                    scheduleSecondReplyInReview(reviewData);
                } else if (delayMinutes !== null) {
                    // ì§€ì—°ì‹œê°„ì´ ìˆìœ¼ë©´ pendingAutoReplyì— ì €ì¥
                    reviewData.pendingAutoReply = {
                        text: autoReplyText.trim(),
                        delayMinutes: delayMinutes,
                        scheduledTime: now + (delayMinutes * 60 * 1000)
                    };
                }
            }
            
            // ìƒˆ ë¦¬ë·° ì¶”ê°€
            reviews.unshift(reviewData); // ìµœì‹  ë¦¬ë·°ê°€ ìœ„ì— ì˜¤ë„ë¡
            localStorage.setItem('reviews', JSON.stringify(reviews));
            
            alert('ë¦¬ë·°ê°€ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\n\ní‰ì : ' + selectedRating + 'ì \n\në¦¬ë·° ë‚´ìš©:\n' + reviewContent);
            
            // í¼ ì´ˆê¸°í™”
            document.getElementById('reviewForm').reset();
            selectedRating = 0;
            updateStars();
            ratingValue.textContent = '0ì ';
        });
    </script>
</body>
</html>

